<div class="landing-container">
    <!-- Header / Navbar -->
    <header class="landing-header">
        <div class="header-content">
            <div class="logo-section">
                <img src="assets/img/logo.png" alt="Logo" height="50">
            </div>
            <nav class="nav-menu">
                <a href="#" class="nav-link">Inicio</a>
                <a href="#" class="nav-link">Quiénes Somos</a>
                <a href="#" class="nav-link">Servicios</a>
                <a href="#" class="nav-link">Encuestas</a>
                <a href="#" class="nav-link">Contacto</a>
            </nav>
        </div>
    </header>

    <!-- Selector Section -->
    <section class="selector-section">
        <div class="selector-content">
            <h2 class="selector-title">Rumbo al 2027</h2>
            <p-dropdown [options]="estados" [(ngModel)]="estadoSeleccionado" 
                placeholder="Selecciona un estado" optionLabel="nombre"
                (onChange)="onEstadoChange()"
                styleClass="estado-dropdown"></p-dropdown>
        </div>
    </section>

    <!-- Banner Principal -->
    <section class="banner-section">
        <div class="banner-content">
            <div class="banner-logos">
                <div class="logo-left">
                    <img src="assets/img/logo.png" alt="Logo" height="60">
                    <div class="logo-text">
                        <span class="brand-name">ENCUESTAS</span>
                        <span class="brand-subtitle">ESTUDIOS DE OPINIÓN PÚBLICA</span>
                    </div>
                </div>
                <div class="date-badge">
                    <span>{{ fechaActual | date:'d \'DE\' MMMM yyyy' | uppercase }}</span>
                </div>
                <div class="logo-right">
                    <img src="assets/img/logo.png" alt="Partner Logo" height="50">
                </div>
            </div>
            
            <h1 class="main-title">RUMBO AL 2027</h1>
        </div>
    </section>

    <!-- Preferencias Electorales -->
    <section class="results-section">
        <div class="results-header">
            <h2>PREFERENCIAS ELECTORALES POR PARTIDO</h2>
        </div>
        
        <div class="results-content">
            <div class="question-section">
                <p class="question-intro">Si hoy fueran las elecciones para elegir gobernador(a),</p>
                <h3 class="question-main">¿Por cuál partido votaría?</h3>
                <p class="question-note">(Medición de partidos políticos SIN alianzas/coaliciones)</p>
            </div>

            <!-- Barras de Resultados -->
            <div class="results-bars">
                <div class="result-item" *ngFor="let partido of partidos">
                    <div class="party-logo">
                        <div class="logo-circle" [style.border-color]="partido.color">
                            <span [style.color]="partido.color">{{ partido.siglas }}</span>
                        </div>
                    </div>
                    <div class="party-bar-container">
                        <div class="party-name-bar" [style.background]="partido.color">
                            <span class="party-name">{{ partido.nombre }}</span>
                        </div>
                        <span class="party-full-name">{{ partido.nombreCompleto }}</span>
                    </div>
                    <div class="party-percentage" [style.background]="partido.colorPorcentaje">
                        <span class="chevron">»</span>
                        <span class="percentage">{{ partido.porcentaje }}%</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Evolución Mensual -->
    <section class="evolution-section">
        <div class="evolution-header">
            <h2>EVOLUCIÓN MENSUAL DE PREFERENCIAS</h2>
            <p class="evolution-subtitle">Tendencias de votación por partido durante el año</p>
            <p class="evolution-note">* Los porcentajes son calculados en base al total de votos válidos por mes</p>
        </div>
        
        <div class="evolution-content">
            <div class="evolution-table-container" *ngIf="datosMensuales.length > 0" 
                 style="height: auto !important; max-height: none !important; overflow-y: visible !important;">
                <table class="evolution-table" 
                       style="height: auto !important; max-height: none !important;">
                    <thead>
                        <tr>
                            <th class="party-header">Partido</th>
                            <th *ngFor="let datoMes of datosMensuales" class="month-header-cell">{{ datoMes.mes }}</th>
                        </tr>
                    </thead>
                    <tbody style="height: auto !important; max-height: none !important;">
                        <tr *ngFor="let partido of getUniquePadridos(); trackBy: trackByPartido" 
                            class="party-row"
                            style="height: auto !important; min-height: 60px; display: table-row !important;">
                            <td class="party-name-cell">
                                <div class="party-info">
                                    <div class="party-color" [style.background]="getPartidoColor(partido)"></div>
                                    <span>{{ partido }}</span>
                                </div>
                            </td>
                            <td *ngFor="let datoMes of datosMensuales" class="percentage-cell">
                                <div class="percentage-container">
                                    <span class="percentage-value">{{ getPercentageForPartyAndMonth(partido, datoMes.mes) }}%</span>
                                    <div class="mini-bar">
                                        <div class="mini-bar-fill" 
                                             [style.background]="getPartidoColor(partido)"
                                             [style.width.%]="getPercentageForPartyAndMonth(partido, datoMes.mes)">
                                        </div>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                    <tfoot style="background: #f1f5f9; font-weight: 600;">
                        <tr>
                            <td class="party-name-cell" style="background: #e2e8f0;">
                                <div class="party-info">
                                    <span style="font-weight: 700; color: #1e293b;">TOTAL</span>
                                </div>
                            </td>
                            <td *ngFor="let datoMes of datosMensuales" class="percentage-cell" style="background: #f8fafc;">
                                <div class="percentage-container">
                                    <span class="percentage-value" style="font-weight: 700; color: #059669;">
                                        {{ getTotalVotosDelMes(datoMes.mes) | number:'1.1-1' }}%
                                    </span>
                                </div>
                            </td>
                        </tr>
                    </tfoot>
                </table>
            </div>
            
            <div *ngIf="datosMensuales.length === 0" class="no-evolution-data">
                <i class="pi pi-chart-line"></i>
                <p>No hay datos históricos disponibles para mostrar la evolución mensual.</p>
            </div>
        </div>
    </section>

    <!-- Sección de Encuestas Disponibles -->
    <section class="surveys-section">
        <div class="surveys-header">
            <h2>ENCUESTAS DISPONIBLES</h2>
        </div>
        
        <div class="surveys-grid">
            <div class="survey-card" *ngFor="let encuesta of encuestas">
                <div class="survey-icon">
                    <i class="pi pi-chart-bar"></i>
                </div>
                <div class="survey-info">
                    <h3>{{ encuesta.titulo }}</h3>
                    <p>{{ encuesta.descripcion }}</p>
                    <span class="survey-date">{{ encuesta.fecha | date:'dd/MM/yyyy' }}</span>
                </div>
                <button pButton pRipple type="button" label="Participar" 
                    [routerLink]="['/encuestas/responder', encuesta.id]" 
                    class="p-button-success survey-btn"></button>
            </div>

            <div *ngIf="encuestas.length === 0" class="no-surveys">
                <i class="pi pi-inbox"></i>
                <p>No hay encuestas disponibles en este momento.</p>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="landing-footer">
        <div class="footer-content">
            <p>&copy; 2026 - Todos los derechos reservados</p>
        </div>
    </footer>
</div>
